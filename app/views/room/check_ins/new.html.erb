<div class="form-group">
    <%= form_with(model: @check_in, url: room_reservation_check_in_path(@reservation), method: :post, local: true) do |f| %>

        <%= error_messages(@check_in) if @check_in.errors.any? %>

        <div class="mb-4">
            <%= f.label :reservation_id, "Reservation", class: "form-label" %>
            <div class="relative">
                <%= f.collection_select :reservation_id, Reservation.where(id: @reservation.id), :id, :id, { prompt: "Select Reservation" }, class: input_class(@check_in, :reservation_id) %>
                <%= error_icon(@check_in, :reservation_id) %>
            </div>
            <%= field_error_tag(@check_in, :reservation_id) %>
        </div>

        <!--<div class="mb-4">
        <%= f.label :user_id, "User", class: "form-label" %>
            <div class="relative">
                <%= f.collection_select :user_id, User.all, :id, :email, 
                    { 
                        prompt: "Select User", 
                        selected: current_user.id 
                    }, 
                    class: input_class(@check_in, :user_id) 
                %>
                <%= error_icon(@check_in, :user_id) %>
            </div>
            <%= field_error_tag(@check_in, :user_id) %>
        </div>
        -->

        <div class="mb-4">
            <%= f.label :user_id, "User", class: "form-label" %>
            <div class="relative">
                <%= f.collection_select :user_id, [current_user], :id, :email, 
                    { 
                        prompt: "Select User", 
                        selected: current_user.id 
                    }, 
                    class: input_class(@check_in, :user_id) 
                %>
                <%= error_icon(@check_in, :user_id) %>
            </div>
            <%= field_error_tag(@check_in, :user_id) %>
        </div>

        <div class="mb-4">
            <%= f.label :check_in_time, "Check-In Time", class: "form-label" %>
            <div class="relative">
                <%= f.datetime_local_field :check_in_time, value: @check_in.check_in_time || Time.now.strftime("%Y-%m-%dT%H:%M"), class: input_class(@check_in, :check_in_time) %>
                <%= error_icon(@check_in, :check_in_time) %>
            </div>
            <%= field_error_tag(@check_in, :check_in_time) %>
        </div>


        <div class="flex space-x-2">
            <%= f.submit @check_in.persisted? ? "Update Check-In" : "Create Check-In", class: "bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg" %>
            <%= link_to "Cancel", reservation_path(@reservation), class: "bg-gray-400 hover:bg-gray-500 text-white px-4 py-2 rounded-lg" %>
        </div>

    <% end %>
</div>
